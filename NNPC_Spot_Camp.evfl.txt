flow Flow_Amiibo():
    if not System.EventFlags['cPlayer:CampFirstTalk']:
        if System.EventFlags['cPlayer:CampInvite']:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:201', false)
            System.EventFlags['cPlayer:CampFirstTalk'] = true
        else:
            EventFlowSystemActor.SetPlayerNameCallCamperNpc()
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:202', false)
            System.EventFlags['cPlayer:CampFirstTalk'] = true
    elif MainNpc.CheckNpcMoveIn('cDefault'):
        if EventFlowSystemActor.PercentChoice(30):
            run Talk_Move()
        else:
            run Talk_Free()
    elif MainNpc.CheckCamperNpcMovePoint() not in (0, 1, 2):
        if (EventFlowSystemActor.NetIsConnected()) or (MainNpc.IsSameNpcLiving()) or (EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0):
            run Talk_Free()
        elif System.EventFlags['cPlayer:Camp_InduceFailFlag']:
            run NNPC_Spot_Camp_Invite::Flow_ReInvite()
        else:
            run Talk_Invite_Amiibo()
    elif System.EventFlags['cLand:CampQuestClear']:
        if MainNpc.CheckCamperNpcMovePoint() in (1, 2):
            if (EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) != 0) and (not System.EventFlags['cPlayer:Camp_InduceFailFlag']):
                run Talk_Invite_Amiibo()
            elif EventFlowSystemActor.RandomChoice2(2) == 0:
                run NNPC_Spot_Camp_Quest::Talk_Ftr()
            else:
                run Talk_Free()
    elif System.EventFlags['cLand:CampQuestInProgress']:
        if (System.EventFlags['cPlayer:CampQuestAccept']) and (MainNpc.HasCamperQuestItem()):
            run NNPC_Spot_Camp_Quest::Talk_QuestClear()
        elif EventFlowSystemActor.PercentChoice(30):
            run NNPC_Spot_Camp_Quest::Talk_QuestProgress()
        else:
            run Talk_Free()
    elif System.EventFlags['cPlayer:CampQuestRecipiFailed']:
        if EventFlowSystemActor.ShoppingCapacity('cItemName', 5794):
            run NNPC_Spot_Camp_Quest::Talk_QuestStart_Re()
        else:
            run Talk_Free()
    elif EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        run NNPC_Spot_Camp_Quest::Talk_QuestStart()
    else:
        run Talk_Free()

flow Flow_FirstCamperZK():
    if not System.EventFlags['cPlayer:MakeVillagePlayerFlag']:
        run Flow_FirstCamperZK_2P()
    elif not System.EventFlags['cPlayer:CampFirstTalk_FirstVisitor']:
        System.EventFlags['cPlayer:CampFirstTalk_FirstVisitor'] = true
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:001', false)
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:001_01', false)
    elif System.EventFlags['cLand:RcoBuildFirstVisitorsHousingKitOngoing']:
        if not System.EventFlags['cLand:RcoBuildFirstVisitorsHousingKitComplete']:
            if System.EventFlags['cPlayer:TalkFirstCamperAfterRequestSetHousing']:
                MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:004_02', false)
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:004_01', false)
                System.EventFlags['cPlayer:TalkFirstCamperAfterRequestSetHousing'] = true
        elif System.EventFlags['cLand:ReportFirstCamperAboutSetHousing']:
            MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:007', false)
        else:
            if System.EventFlags['cPlayer:TalkFirstCamperAfterRequestSetHousing']:
                MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:005_01', false)
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:005', false)
            System.EventFlags['cLand:ReportFirstCamperAboutSetHousing'] = true
            System.EventFlags['cPlayer:TalkFirstCamperAfterSetHousing'] = true
    elif System.EventFlags['cLand:RcoMeetFirstVisitorComplete']:
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:004', false)
    elif not EventFlowSystemActor.NetHasVisitor():
        switch EventFlowSystemActor.RandomChoice3(3):
            case 0:
                MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:002_01', false)
            case 1:
                MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:002_02', false)
            case 2:
                MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:002_03', false)
        switch EventFlowSystemActor.GeneralTalkChoice2():
            case 0, 1:
                MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:003', false)
                switch EventFlowSystemActor.GeneralTalkChoice2():
                    case 0, 1:
                        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:003_01', false)
                        EventFlowSystemActor.Set6thVillager(0)
                        System.EventFlags['cPlayer:IslandDevQuestOrderFirstCamperMyself'] = true
                        System.EventFlags['cLand:RcoMeetFirstVisitorComplete'] = true
    elif System.EventFlags['cPlayer:Talk1stCamperMultiplay']:
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp:301', false)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:101', false)
        System.EventFlags['cPlayer:Talk1stCamperMultiplay'] = true

flow Flow_FirstCamperZK_2P():
    if not System.EventFlags['cPlayer:CampFirstTalk_FirstVisitor']:
        System.EventFlags['cPlayer:CampFirstTalk_FirstVisitor'] = true
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:101', false)
    elif not System.EventFlags['cLand:RcoMeetFirstVisitorComplete']:
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp:301', false)
    elif not System.EventFlags['cLand:ReportFirstCamperAboutSetHousing']:
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:006', false)
    elif System.EventFlags['cPlayer:TalkFirstCamperAfterSetHousing']:
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:007', false)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B4_Zk/Spot/ZK_Spot_Camp_First:008', false)
        System.EventFlags['cPlayer:TalkFirstCamperAfterSetHousing'] = true

flow Flow_Normal():
    if System.EventFlags['cLand:CampFirstCamperVisit']:
        run Flow_FirstCamperZK()
    elif not System.EventFlags['cPlayer:CampFirstTalk']:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:101', false)
        System.EventFlags['cPlayer:CampFirstTalk'] = true
    elif MainNpc.CheckNpcMoveIn('cDefault'):
        if (EventFlowSystemActor.PercentChoice(30)) and (System.EventFlags['cPlayer:CampGameClear'] != 3) and (not ((System.EventFlags['cPlayerTemp:CampGameStartFailed']) and (EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1))):
            run NNPC_Spot_Camp_Game::Root()
        elif EventFlowSystemActor.PercentChoice(30):
            run Talk_Move()
        else:
            run Talk_Free()
    elif (EventFlowSystemActor.CheckMoveOutNpcIsMoveKitVillager()) or (MainNpc.IsSameNpcLiving()):
        if (EventFlowSystemActor.PercentChoice(38)) and (System.EventFlags['cPlayer:CampGameClear'] != 3) and (not ((System.EventFlags['cPlayerTemp:CampGameStartFailed']) and (EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1))):
            run NNPC_Spot_Camp_Game::Root()
        else:
            run Talk_Free()
    elif System.EventFlags['cPlayer:Camp_InduceFailFlag']:
        switch EventFlowSystemActor.PercentChoice3(50, 20, 30):
            case 0:
                if EventFlowSystemActor.NetIsConnected():
                    run Talk_Free()
                else:
                    run NNPC_Spot_Camp_Invite::Flow_ReInvite()
            case 1:
                run Talk_Free()
            case 2:
                if (System.EventFlags['cPlayer:CampGameClear'] != 3) and (not ((System.EventFlags['cPlayerTemp:CampGameStartFailed']) and (EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1))):
                    run NNPC_Spot_Camp_Game::Root()
                else:
                    if EventFlowSystemActor.PercentChoice(70):
                        if EventFlowSystemActor.NetIsConnected():
                            run Talk_Free()
                        else:
                            run NNPC_Spot_Camp_Invite::Flow_ReInvite()
                    else:
                        run Talk_Free()
    else:
        switch EventFlowSystemActor.PercentChoice3(20, 50, 30):
            case 0:
                if EventFlowSystemActor.NetIsConnected():
                    run Talk_Free()
                else:
                    run Talk_Invite_Normal()
            case 1:
                run Talk_Free()
            case 2:
                if (System.EventFlags['cPlayer:CampGameClear'] != 3) and (not ((System.EventFlags['cPlayerTemp:CampGameStartFailed']) and (EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1))):
                    run NNPC_Spot_Camp_Game::Root()
                else:
                    if EventFlowSystemActor.PercentChoice(30):
                        if EventFlowSystemActor.NetIsConnected():
                            run Talk_Free()
                        else:
                            run Talk_Invite_Normal()
                    else:
                        run Talk_Free()

flow Root():
    MainNpc.AddMemoryEventPlayerForNpc('NNPC_CampSiteTalk')
    System.EventFlags['cPlayerTemp:CampCurrentSceneTalkDone'] = true
    if EventFlowSystemActor.IsMyVillage():
        if System.EventFlags['cLand:AmiiboCampSiteCall']:
            run Flow_Amiibo()
        else:
            run Flow_Normal()
    elif MainNpc.CheckNpcMoveIn('cDefault'):
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:003', false)
    elif System.EventFlags['cLand:AmiiboCampSiteCall']:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:002', false)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:001', false)

flow Talk_Free():
    if System.EventFlags['cLand:AmiiboCampSiteCall']:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:302', false)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:301', false)

flow Talk_Invite_Amiibo():
    switch MainNpc.CheckCamperNpcMovePoint():
        case 1:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp_Invite:504', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp_Invite:505', false)
                System.EventFlags['cPlayer:Camp_InduceFailFlag'] = true
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp_Invite:506', false)
        case 2:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp_Invite:507', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp_Invite:508', false)
                System.EventFlags['cPlayer:Camp_InduceFailFlag'] = true
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp_Invite:509', false)
        case 3:
            switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, true):
                case 0:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:601_01', false)
                    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                        run NNPC_Spot_Camp_Invite::Flow_Invite()
                    else:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:602_01', false)
                case 1:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:601_02', false)
                    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                        run NNPC_Spot_Camp_Invite::Flow_Invite()
                    else:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:602_02', false)
                case 2:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:601_03', false)
                    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                        run NNPC_Spot_Camp_Invite::Flow_Invite()
                    else:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:602_03', false)
        default:
            return

flow Talk_Invite_Normal():
    switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, true):
        case 0:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:501_01', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run NNPC_Spot_Camp_Invite::Flow_Invite()
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:502_01', false)
        case 1:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:501_02', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run NNPC_Spot_Camp_Invite::Flow_Invite()
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:502_02', false)
        case 2:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:501_03', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run NNPC_Spot_Camp_Invite::Flow_Invite()
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:502_03', false)

flow Talk_Move():
    if MainNpc.CheckNpcMoveIn('cMainPlayer'):
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:401', false)
    elif MainNpc.InducePlayerExist():
        MainNpc.SetInvitePlayerName()
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:402', false)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Spot/BO_Spot_Camp:403', false)

