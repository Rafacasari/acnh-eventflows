flow Report():
    EventFlowSystemActor.UIIllegalReportHandling(9)
    if EventFlowSystemActor.UIIllegalReportResult():
        if EventFlowSystemActor.NetWherearenIsFollowedAuthor():
            EventFlowSystemActor.MessageLockNext(1)
            EventFlowSystemActor.NetWherearenRemoveFollowList('cInspect')
            System.EventFlags['cPlayerTemp:WHEREAREN_ResortPlanner_IsFollowUpdated'] = true
        EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:106', false)
        EventFlowSystemActor.MessageSuspend()
        EventFlowSystemActor.MessageUnlockNext()
        EventFlowSystemActor.StopMeasurePlayTime('cWherearenInspect')
        EventFlowSystemActor.PlayReport('cWherearenInspect', 0)
        EventFlowSystemActor.UIWherearenInspectFootPrintAllClear()
        run Event16()

local flow Sub_grp_Event2():
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        EventFlowSystemActor.WherearenOrderCallback('cSuspend')
        EventFlowSystemActor.WherearenOrderCallback('cFinish')
        EventFlowSystemActor.MessageSuspend()
        System.EventFlags['cWherearenPlayer:OtgWithoutMakeup'] = false
        EventFlowSystemActor.ReserveSystemFlowDemo('System_SaveGameClose', 'Root', false, false, false)
        EventFlowSystemActor.SystemRequestChangeStage('cSaveGameClose', 'cCircle', 'cCircle', 'cBlack', 1.0, 1.0)

flow WherearenClose():
    if not System.EventFlags['cWherearenPlayer:OtgGetStartingSalary']:
        EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:100', false)
    elif not EventFlowSystemActor.IsInspectingWherearen():
        switch EventFlowSystemActor.WherearenOrderStatus():
            case 0, 1:
                EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:101', false)
                run Sub_grp_Event2()
            case 2:
                if System.EventFlags['cWherearenPlayer:NoticeAboutInsectEdit']:
                    EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:110', false)
                    run Sub_grp_Event2()
                else:
                    EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:102', false)
                    run Sub_grp_Event2()
            case 3:
                if System.EventFlags['cWherearenPlayer:IsParty']:
                    run SNPC_otg_18_WherearenEvent_Party::Leave_WherearenParty()
            case 6:
                EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:108', false)
            default:
                return
    elif EventFlowSystemActor.NetWherearenIsMyOpusData():
        EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:109', false)
    else:
        EventFlowSystemActor.NetCaptureScreenshot()
        EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:103', false)
        switch EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:104', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    EventFlowSystemActor.MessageSuspend()
                    EventFlowSystemActor.StopMeasurePlayTime('cWherearenInspect')
                    EventFlowSystemActor.PlayReport('cWherearenInspect', 0)
                    if EventFlowSystemActor.CheckMeasuredPlayTime('cWherearenInspect', 20):
                        System.EventFlags['cPlayerTemp:WHEREAREN_NeedsInspectReply'] = true
entrypoint Event16:
                    run System_WherearenResortPlanner::Setting_ReturnInspect()
                    EventFlowSystemActor.SystemRequestChangeStage('cWherearenPlannerApp', 'cWherearenInspectBack', 'cWherearenInspectBack', 'cBlack', 1.0, 1.0)
            case 1:
                EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_CloseMenu:105', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    run Report()
            default:
                return

