flow RcmCmnGreeting():
    EventFlowSystemActor.UIMoneyAppear()
    if System.EventFlags['cPlayerTemp:RcmTalkSceneFlag']:
        MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:014', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:013', false)

flow RcmConfirmConsultation():
    System.EventFlags['cPlayer:RcmTookQuestReq'] = true
    MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:012_01', false)
    MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:012_02', false)
    switch EventFlowSystemActor.GeneralTalkChoice2():
        case 0, 1:
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:012_03', false)
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:012_04', false)

flow RcmSelectWithConsultation():
    switch EventFlowSystemActor.GeneralTalkChoice4():
        case 0:
            run SNPC_rcm_00_Common_Sell::Root()
        case 1:
            run SNPC_rcm_00_Common::Rcm_Common_Buy()
        case 2:
            run RcmConfirmConsultation()
        case 3:
            run SNPC_rcm_00_Common::rcm_Common_End()

flow RcmTentRequestSel4B():
    switch EventFlowSystemActor.GeneralTalkChoice4():
        case 0:
            run SNPC_rcm_21_MaterialCollecting::Root()
        case 1:
            run SNPC_rcm_00_Common_Sell::Root()
        case 2:
            run SNPC_rcm_00_Common::Rcm_Common_Buy()
        case 3:
            run SNPC_rcm_00_Common::rcm_Common_End()

flow ReportTent():
    if System.EventFlags['cLand:Prologue4BuiltShop']:
        MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:024', false)
        System.EventFlags['cPlayer:Prologue4RcmBuiltShop'] = true
    else:
        run RcmCmnGreeting()
        switch EventFlowSystemActor.GeneralTalkChoice4():
            case 0:
                MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:023', false)
            case 1:
                run SNPC_rcm_00_Common_Sell::Root()
            case 2:
                run SNPC_rcm_00_Common::Rcm_Common_Buy()
            case 3:
                run SNPC_rcm_00_Common::rcm_Common_End()

flow Request():
    if System.EventFlags['cPlayer:RcmDeclinedQuestReq']:
        if System.EventFlags['cPlayerTemp:RcmTalkSceneFlag']:
            EventFlowSystemActor.UIMoneyAppear()
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:011', false)
            run RcmSelectWithConsultation()
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:010', false)
            run Sub_Event47()
    else:
        if System.EventFlags['cPlayerTemp:RcmTalkSceneFlag']:
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:001_00', false)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:001', false)
        if System.EventFlags['cPlayer:PlayerProducedByPlayerMoving']:
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:001_01_01', false)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:001_01', false)
        MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:001_10', false)
        run Sub_Event47()

flow Root():
    run RcmCmnGreeting()
    run RcmTentRequestSel4B()

local flow Sub_Event47():
    System.EventFlags['cPlayerTemp:RcmTalkSceneFlag'] = true
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run RcmConfirmConsultation()
    else:
        if System.EventFlags['cPlayer:RcmDeclinedQuestReq']:
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:002_02', false)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:002', false)
            System.EventFlags['cPlayer:RcmDeclinedQuestReq'] = true
        EventFlowSystemActor.UIMoneyAppear()
        MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_02_TentRequest:002_01', false)
        run RcmSelectWithConsultation()

