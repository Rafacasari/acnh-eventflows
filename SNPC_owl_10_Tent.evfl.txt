flow OwlDailyGreeting():
    if System.EventFlags['cPlayer:FutaTalkedInMuseumToday']:
        run SNPC_owl_22_Museum_RenualQuest::BeforeRenualQuest()
    else:
        System.EventFlags['cPlayer:FutaTalkedInMuseumToday'] = true
        run SNPC_owl_00_Common::Greet()
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:101', false)

flow OwlReadyForBuiltMuseum():
    System.EventFlags['cPlayer:FutaReadyForMuseum'] = true
    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:199_01', false)

flow OwlTentCommon():
    if (not System.EventFlags['cPlayer:OwlGotDiyRecipe']) and (System.EventFlags['cPlayer:MainmenuRecipe']):
        run Owl_GetRecipe_AfterGreeting()
    elif System.EventFlags['cPlayer:OwlShowFossilMyself']:
        run OwlDailyGreeting()
        if not EventFlowSystemActor.MuseumDonationNumCheck(20):
            run OwlTentDefaultChoice()
        elif System.EventFlags['cPlayer:FutaReadyForMuseum']:
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:192', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run SNPC_owl_02_Museum_Judgment::Root()
            else:
                run SNPC_owl_00_Common::End()
        else:
            run OwlReadyForBuiltMuseum()
    elif System.EventFlags['cLand:OwlFoundFossil']:
        System.EventFlags['cPlayer:OwlShowFossilMyself'] = true
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:051', false)
        if not EventFlowSystemActor.MuseumDonationNumCheck(20):
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:052_01', false)
        elif System.EventFlags['cPlayer:FutaReadyForMuseum']:
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:052_02', false)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:052_03', false)
            System.EventFlags['cPlayer:FutaReadyForMuseum'] = true
    else:
        run OwlDailyGreeting()
        if not EventFlowSystemActor.MuseumDonationNumCheck(20):
            run Sel_NoFoundFossil()
        elif not System.EventFlags['cPlayer:FutaReadyForMuseum']:
            run OwlReadyForBuiltMuseum()
        elif EventFlowSystemActor.HasKindItem('cFilter', '', 'Fossils'):
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:194', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:195', false)
                EventFlowSystemActor.UIItemSelectWindowHandling('cItemFilter', 65534, '', 'Fossils', 'cItemSelect', false)
                if EventFlowSystemActor.UIResultMenuDecide():
                    MainNpc.SetDeliveryItem(4, false)
                    EventFlowSystemActor.SetTagFromUIResult('cItemName', 0)
                    MainNpc.NpcDelivery(0, 'Keep')
                    if EventFlowSystemActor.MultiKindItemSelectInclude('FossilUnknown', '', '', '', '', '', '', '', 'cItemSelect'):
                        run SNPC_owl_11_Tent_Entries::owl_DonatedFossil1st_Unknown()
                    else:
                        run SNPC_owl_11_Tent_Entries::owl_DonatedFossil1st_Known()
                else:
                    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:196', false)
            else:
                run SNPC_owl_00_Common::End()
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:193', false)

flow OwlTentDefaultChoice():
    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:103', false)
    switch EventFlowSystemActor.GeneralTalkChoice3():
        case 0:
            run SNPC_owl_01_Museum_Donation::Root()
        case 1:
            run SNPC_owl_02_Museum_Judgment::Root()
        case 2:
            run SNPC_owl_00_Common::End()

flow Owl_GetRecipe_AfterGreeting():
    System.EventFlags['cPlayer:FutaTalkedInMuseumToday'] = true
    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:031', false)
    run SNPC_owl_12_Tent_FirstTimeTalk::ALL_Cmn_SendRecipe()
    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:014', false)

flow Root():
    if System.EventFlags['cPlayer:OwlFinished1stTalk']:
        run OwlTentCommon()
    else:
        run SNPC_owl_12_Tent_FirstTimeTalk::Root()

flow Sel_NoFoundFossil():
    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_01_MuseumTent:102', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run SNPC_owl_01_Museum_Donation::Root()
    else:
        run SNPC_owl_00_Common::End()

