flow `Month_1.3`():
    if EventFlowSystemActor.EnvWeatherArea() == `cWeatherArea_North`:
        run Northern()
    else:
        run Southern()

flow `Month_1.4`():
    if EventFlowSystemActor.EnvWeatherArea() == `cWeatherArea_North`:
        run `Northern_1.4`()
    else:
        run `Southern_1.4`()

flow NNPC_AfterEV():
    if not MainNpc.EventFlags['cNpcMemory:GEventTalkAfterFlag']:
        MainNpc.EventFlags['cNpcMemory:GEventTalkAfterFlag'] = true
        switch EventFlowSystemActor.RandomChoice3(3):
            case 0:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:008', true)
            case 1:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:009', true)
            case 2:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:007', true)
        EventFlowSystemActor.ExitFlowchart()

flow NNPC_BeforeEV():
    switch EventFlowSystemActor.RandomChoice3(3):
        case 0:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:001', true)
        case 1:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:002', true)
        case 2:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:003', true)
    EventFlowSystemActor.ExitFlowchart()

flow NNPC_OpenEV():
    if MainNpc.EventFlags['cNpcMemory:GEventTalkProgressFlag']:
        switch EventFlowSystemActor.RandomChoiceExcludePrevious4(4, true):
            case 0:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:010', true)
            case 1:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:011', true)
            case 2:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:012', true)
            case 3:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:013', true)
        EventFlowSystemActor.ExitFlowchart()
    else:
        MainNpc.EventFlags['cNpcMemory:GEventTalkProgressFlag'] = true
        switch EventFlowSystemActor.RandomChoiceExcludePrevious5(5, true):
            case 0:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:004', true)
            case 1:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:005', true)
            case 2:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:006', true)
            case 3:
                run `Month_1.3`()
            case 4:
                run `Month_1.4`()
        EventFlowSystemActor.ExitFlowchart()

flow Northern():
    switch EventFlowSystemActor.EnvMonth():
        case `June`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:104', false)
        case `July`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:105', false)
        case `August`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:106', false)
        case `September`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:107', false)
        default:
            return

flow `Northern_1.4`():
    switch EventFlowSystemActor.EnvMonth():
        case `June`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:201', false)
        case `July`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:202', false)
        case `August`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:203', false)
        case `September`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:204', false)
        default:
            return

flow Root():
    if EventFlowSystemActor.SystemCheckNowStage('cField'):
        switch EventFlowSystemActor.EventCheck('InsectConvention'):
            case 0:
                run NNPC_BeforeEV()
            case 1:
                run NNPC_OpenEV()
            case 2:
                if EventFlowSystemActor.EnvHourCompare(19, -1, true, true) in (0, 1):
                    run NNPC_AfterEV()
            default:
                return

flow Southern():
    switch EventFlowSystemActor.EnvMonth():
        case `January`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:106', false)
        case `February`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:107', false)
        case `November`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:104', false)
        case `December`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:105', false)
        default:
            return

flow `Southern_1.4`():
    switch EventFlowSystemActor.EnvMonth():
        case `January`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:207', false)
        case `February`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:208', false)
        case `November`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:205', false)
        case `December`:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/GEvent/BO_GEvent_CatchInsectFes:206', false)
        default:
            return

