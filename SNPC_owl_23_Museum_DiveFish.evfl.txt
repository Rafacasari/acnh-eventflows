flow ChkCompReport():
    if (not System.EventFlags['cLand:OwlFoundDiveFish']) and (not EventFlowSystemActor.MuseumComplete()) and (System.EventFlags['cLand:OwlFoundFossil']) and (not System.EventFlags['cPlayer:OwlExplainDiveFishAfterComp']):
        System.EventFlags['cPlayer:OwlExplainDiveFishAfterComp'] = true
        System.EventFlags['cPlayer:FutaExplanationDonationComp'] = false
        System.EventFlags['cPlayer:OwlPaintingDiveFish'] = true
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:001', false)
        EventFlowSystemActor.ExitFlowchart()

flow ChkDiveFishNoticeAtToday1stTalk():
    if (System.EventFlags['cLand:OwlFoundDiveFish']) and (not System.EventFlags['cPlayer:OwlShowDiveFishReport']):
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:301', false)
        System.EventFlags['cPlayer:OwlShowDiveFishReport'] = true
        EventFlowSystemActor.ExitFlowchart()

flow DonateDiveFish(MultiComplete: bool = false, CompleteRoomType: int = 0):
    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:201', false)
    EventFlowSystemActor.UIItemSelectWindowHandling('cItemKind', 65534, 'DiveFish', '', '', false)
    if EventFlowSystemActor.UIResultMenuDecide():
        System.EventFlags['cLand:OwlFoundDiveFish'] = true
        System.EventFlags['cPlayer:OwlShowDiveFishReport'] = true
        System.EventFlags['cPlayer:FutaExplanationDonationComp'] = false
        MainNpc.SetDeliveryItem(4, false)
        EventFlowSystemActor.SetTagFromUIResult('cItemName', 0)
        MainNpc.NpcDelivery(0, 'Keep')
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:120', false)
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:205', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:206', false)
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:131', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:132', false)
                MainNpc.OwlOpenItemMessage()
                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:133', false)
                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:113', true)
            else:
                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:134', true)
            MainNpc.NpcDelivery(3, '"Default"')
            MainNpc.OwlDonationDone(MultiComplete, CompleteRoomType)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:207', false)
            MainNpc.NpcDelivery(10, '"Default"')
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:204', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:202', false)

flow Root():
    if not System.EventFlags['cLand:OwlFoundDiveFish']:
        switch EventFlowSystemActor.MuseumLevel():
            case `BlathersMuseumNoArt`:
                if (System.EventFlags['cLand:OwlWantsPainting']) and (not System.EventFlags['cLand:MuseumGrowupEnable2']) and (System.EventFlags['cPlayer:OwlPaintingQuestExplain']):
                    if System.EventFlags['cPlayer:OwlPaintingDiveFish']:
                        run Select4_DiveFish()
                else:
                    run Select5_DiveFish()
            case `BlathersMuseumArt`:
                if System.EventFlags['cPlayer:OwlPaintingDiveFish']:
                    run Select5_DiveFish()
            case `BlathersCafe`:
                System.EventFlags['cLand:OwlFoundDiveFish'] = true
                run SNPC_owl_22_Museum_RenualQuest::Root()
            default:
                return
    elif System.EventFlags['cPlayer:OwlShowDiveFishReport']:
        switch EventFlowSystemActor.MuseumLevel():
            case `BlathersTent`:
                run SNPC_owl_10_Tent::OwlTentDefaultChoice()
            case `BlathersMuseumNoArt`, `BlathersMuseumArt`, `BlathersCafe`:
                run SNPC_owl_22_Museum_RenualQuest::Root()
            default:
                return
    else:
        run TodayTalk1st()

flow Select4_DiveFish():
    if not EventFlowSystemActor.HasKindItem('cKind', 'DiveFish', ''):
        if (EventFlowSystemActor.HasKindItem('cFilter', 'Picture', 'OwlDonation1_5')) and (not System.EventFlags['cLand:Museum3Built']):
            run SNPC_owl_22_Museum_RenualQuest::Select5_Painting()
        else:
            run SNPC_owl_00_Common::owlNoFishArt()
    elif (EventFlowSystemActor.HasKindItem('cFilter', 'Picture', 'OwlDonation1_5')) and (not System.EventFlags['cLand:Museum3Built']):
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:103', false)
        switch EventFlowSystemActor.GeneralTalkChoice6():
            case 0:
                run DonateDiveFish()
            case 1:
                run SNPC_owl_22_Museum_RenualQuest::DonatePainting()
            case 2:
                run SNPC_owl_01_Museum_Donation::Root()
            case 3:
                run SNPC_owl_02_Museum_Judgment::Root()
            case 4:
                run SNPC_owl_03_Museum_Commentary::Root()
            case 5:
                run SNPC_owl_00_Common::End()
    else:
        run Select5_DiveFish()

flow Select4_DiveFish_Again():
    if EventFlowSystemActor.HasKindItem('cKind', 'DiveFish', ''):
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:104', false)
        switch EventFlowSystemActor.GeneralTalkChoice4():
            case 0:
                run DonateDiveFish()
            case 1:
                run SNPC_owl_01_Museum_Donation::Root()
            case 2:
                run SNPC_owl_02_Museum_Judgment::Root()
            case 3:
                run SNPC_owl_00_Common::End()
    else:
        run SNPC_owl_00_Common::Select3_Again()

flow Select5_DiveFish():
    if EventFlowSystemActor.HasKindItem('cKind', 'DiveFish', ''):
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:101', false)
        switch EventFlowSystemActor.GeneralTalkChoice5():
            case 0:
                run DonateDiveFish()
            case 1:
                run SNPC_owl_01_Museum_Donation::Root()
            case 2:
                run SNPC_owl_02_Museum_Judgment::Root()
            case 3:
                run SNPC_owl_03_Museum_Commentary::Root()
            case 4:
                run SNPC_owl_00_Common::End()
    else:
        run SNPC_owl_22_Museum_RenualQuest::Root()

flow Select5_DiveFish_Again():
    if EventFlowSystemActor.NetHasVisitor():
        run SNPC_owl::NoTopic()
    elif EventFlowSystemActor.HasKindItem('cKind', 'DiveFish', ''):
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:102', false)
        switch EventFlowSystemActor.GeneralTalkChoice5():
            case 0:
                run DonateDiveFish()
            case 1:
                run SNPC_owl_01_Museum_Donation::Root()
            case 2:
                run SNPC_owl_02_Museum_Judgment::Root()
            case 3:
                run SNPC_owl_03_Museum_Commentary::Root()
            case 4:
                run SNPC_owl_00_Common::End()
    else:
        run SNPC_owl_00_Common::Painting_Again()

flow SkipDIveFishNotice_Comp():
    if (System.EventFlags['cLand:OwlFoundDiveFish']) and (not System.EventFlags['cPlayer:OwlShowDiveFishReport']):
        System.EventFlags['cPlayer:OwlShowDiveFishReport'] = true

flow TodayTalk1st():
    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_23_Museum_DiveFish:301', false)
    System.EventFlags['cPlayer:OwlShowDiveFishReport'] = true

