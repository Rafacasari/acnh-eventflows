flow BackToEdit():
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2063', false)

flow ChangeHouseDesign():
    if (not EventFlowSystemActor.IsOnNpcExteriorReserveFlag()) and (not System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']):
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2031', true)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2032', true)
    EventFlowSystemActor.UICustomNpcHomeHandling()
    if not EventFlowSystemActor.UIResultMenuDecide():
        if SubflowResults@2[1] == 0:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2036', false)
        else:
            if EventFlowSystemActor.IsOnNpcExteriorReserveFlag():
                MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2025', false)
                run Sub_grp_Event50()
            else:
                MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2024', false)
                run Sub_grp_Event50()
    elif SubflowResults@2[1] == 0:
        if EventFlowSystemActor.IsOnNpcInteriorReserveFlag():
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2034', false)
        else:
            if (not System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']) and (not EventFlowSystemActor.IsOnNpcExteriorReserveFlag()):
                MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2033', false)
            else:
                MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2035', false)
        System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged'] = true
    else:
        System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged'] = true
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2023', false)
        run Sub_grp_Event50()

flow ChkAct():
    EventFlowSystemActor.WaitFrame(5)
    if MainNpc.NpcIsSitting() in (0, 4, 5):
        MainNpc.TurnNeck(11, false)
        MainNpc.TurnBody(17, 0.0)
        EventFlowSystemActor.WaitFrame(45)
        MainNpc.TurnNeck(10, false)
        MainNpc.TurnBody(10, 0.0)

flow End_NpcHouseEdit():
    if EventFlowSystemActor.IsOnNpcExteriorReserveFlag():
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2027', true)
        run Sub_Event109()
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2026', true)
        run Sub_Event109()

flow ForceTalk():
    MainNpc.NpcHouseEditItemMerge()
    EventFlowSystemActor.SetTagFromSystem('cUISelectedNpcName', 'cDegit', 0, 0, '')
    EventFlowSystemActor.WaitFrame(30)
    MainNpc.TurnNeck(10, false)
    MainNpc.TurnBody(10, 0.0)
    EventFlowSystemActor.WaitFrame(15)
    Player.TurnNeck(0, false)
    Player.TurnBody(0, 0.0)
    if EventFlowSystemActor.IsOnNpcInteriorReserveFlag():
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2002', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2001', false)
        if not System.EventFlags['cPlayer:TalkAboutNpcHouseCoordeHint']:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2001_01', false)
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2001_02', false)
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2001_03', false)
            System.EventFlags['cPlayer:TalkAboutNpcHouseCoordeHint'] = true
    if System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2003_02', false)
    elif EventFlowSystemActor.IsOnNpcExteriorReserveFlag():
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2003_03', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2003_01', false)

flow Gate():
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2101', true)
    run Sub_Event6()

flow Gate_monolog():
    Player.OpenMessageWindow('TalkSys/SYS_Player:1601', true)
    run Sub_Event6()

flow NoChangeExterior():
    if EventFlowSystemActor.IsOnNpcExteriorReserveFlag():
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2022', false)
        run Event46()
    else:
        run Event26()

flow Root():
    EventFlowSystemActor.SetTagFromSystem('cUISelectedNpcName', 'cDegit', 0, 0, '')
    if System.EventFlags['cLandTemp:NpcHouseCoordinateIsRetake']:
        if (not EventFlowSystemActor.IsOnNpcExteriorReserveFlag()) and (not System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']):
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2013', false)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2014', false)
    else:
        if System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2012', false)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2011', false)
    switch EventFlowSystemActor.GeneralTalkChoice4():
        case 0:
            EventFlowSystemActor.MessageSuspend()
            run ChkAct()
            if not EventFlowSystemActor.HasNpcHouseCoordinateEndSpace():
                MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2102', false)
            elif not EventFlowSystemActor.HasNpcHouseCoordinateEntranceSpace():
                MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2103', false)
            elif System.EventFlags['cLandTemp:NpcHouseCoordinateIsRetake']:
                if System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']:
                    if EventFlowSystemActor.IsOnNpcInteriorReserveFlag():
                        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2027_01', true)
                        run Sub_Event109()
                    else:
                        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2026_01', true)
                        run Sub_Event109()
                else:
                    run NoChangeExterior()
            elif System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']:
                MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2026_01', true)
                run Sub_Event109()
            else:
entrypoint Event26:
                MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2021', false)
entrypoint Event46:
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    SubflowResults[1] = 1
                    run ChangeHouseDesign()
                else:
                    run End_NpcHouseEdit()
        case 1:
            SubflowResults[1] = 0
            run ChangeHouseDesign()
        case 2:
            if System.EventFlags['cLandTemp:NpcHouseCoordinateIsRetake']:
                if not EventFlowSystemActor.IsOnNpcExteriorReserveFlag():
                    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2055', false)
                elif EventFlowSystemActor.IsOnNpcInteriorReserveFlag():
                    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2053', false)
                else:
                    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2054', false)
            else:
                if System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']:
                    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2052', false)
                else:
                    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2051', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                if System.EventFlags['cLandTemp:NpcHouseCoordinateIsRetake']:
                    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2062', true)
                else:
                    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_14_CoordinateNpcHouse:2061', true)
                    EventFlowSystemActor.SetNpcExteriorReserveFlag(false)
                EventFlowSystemActor.StructureTranscriptNpcHouseCustom(1)
                EventFlowSystemActor.CameraReserveFirstStateCommand('Talk:rco', '', false)
                EventFlowSystemActor.SystemRequestChangeStage('cIdrOffice01', 'cCircle', 'cCircle', 'cBlack', 1.0, 1.0)
            else:
                run BackToEdit()
        case 3:
            run BackToEdit()

local flow Sub_Event109():
    EventFlowSystemActor.SoundDuckingOn(62)
    EventFlowSystemActor.SoundTriggerEmit('Demo_RequestOkay', -1)
    fork:
        branch:
            Player.CharacterEmoticonAction('RequestOkay', true, '', 0, false)
        branch:
            MainNpc.CharacterEmoticonAction('Smiling', true, '', 0, false)
    EventFlowSystemActor.SoundDuckingOff(62)
    EventFlowSystemActor.WaitFrame(30)
    run `00_Demo_Fade`::FadeOut_Cmn(FadeType='cCircle', FadeColor='cBlack', FadeSpeed='cNormal', SoundDucking='cWorldDucking')
    if System.EventFlags['cLandTemp:NpcHouseCoordinateHouseDesignChanged']:
        EventFlowSystemActor.StructureTranscriptNpcHouseCustom(0)
        EventFlowSystemActor.SetNpcExteriorReserveFlag(true)
    System.EventFlags['cLandTemp:NpcInteriorCoordinateDone'] = true
    EventFlowSystemActor.SetNpcInteriorReserveFlag(true)
    EventFlowSystemActor.CameraReserveFirstStateCommand('Talk:rco', '', false)
    EventFlowSystemActor.SystemRequestChangeStage('cIdrOffice01', 'cCircle', 'cCircle', 'cBlack', 1.0, 1.0)

local flow Sub_Event6():
    Player.PlayerDemoMove('cNextInfoAngle', 1)

local flow Sub_grp_Event50():
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run End_NpcHouseEdit()
    else:
        run BackToEdit()

