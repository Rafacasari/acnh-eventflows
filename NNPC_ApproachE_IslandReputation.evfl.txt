flow Root():
    MainNpc.SetIslandReputationApproachVillagerIndex(1)
    MainNpc.EventFlags['cNpcSave:AppE_Rep_HappenToday'] = true
    if MainNpc.EventFlags['cNpcSave:AppE_Happen1st']:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:111', false)
        if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:112', false)
        else:
            if MainNpc.EventFlags['cNpcSave:AppE_GetItem1st']:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:113_02', true)
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:113_01', true)
            if EventFlowSystemActor.RandomChoice2(2) == 0:
                MainNpc.NpcDecideRewardByCondition(10, 0, false, true)
                MainNpc.SetItemName(1, 0, 0)
                MainNpc.SetDeliveryItem(1, true)
                MainNpc.NpcDelivery(1, 'Keep')
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:114_03', true)
                run Sub_Event28()
            else:
                switch EventFlowSystemActor.RandomChoiceExcludePrevious4(4, false):
                    case 0:
                        MainNpc.NpcDecideRewardByCondition(6, 0, false, true)
                        run Sub_Event34()
                    case 1:
                        MainNpc.NpcDecideRewardByCondition(8, 0, false, true)
                        run Sub_Event34()
                    case 2:
                        MainNpc.NpcDecideRewardByCondition(9, 0, false, true)
                        run Sub_Event34()
                    case 3:
                        MainNpc.NpcDecideRewardByCondition(7, 0, false, true)
                        MainNpc.SetItemName(1, 0, 0)
                        MainNpc.SetDeliveryItem(1, true)
                        MainNpc.NpcDelivery(1, 'Keep')
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:114_02', true)
                        run Sub_Event28()
    else:
        MainNpc.EventFlags['cNpcSave:AppE_Happen1st'] = true
        if (MainNpc.CheckNpcLook() not in (0, 1, 2, 4, 6, 7)) and (MainNpc.EventFlags['cNpcSave:MarketBuildingSupport']):
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:101_02', false)
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:101_01', false)
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:102', false)
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:103', false)
        if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:104_01', false)
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:104_02', true)
            MainNpc.NpcDecideRewardByCondition(6, 0, false, true)
            MainNpc.SetItemName(1, 0, 0)
            MainNpc.SetDeliveryItem(1, true)
            MainNpc.NpcDelivery(1, 'Keep')
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:105', true)
            run Sub_Event28()

local flow Sub_Event28():
    MainNpc.NpcDelivery(2, 'Default')
    System.EventFlags['cLand:CountAppE_RepTalk'] += 1
    MainNpc.EventFlags['cNpcSave:AppE_GetItem1st'] = true
    System.EventFlags['cPlayer:NnpcAppE_Rep_OccuredToday'] = true
    System.EventFlags['cPlayer:NnpcApproachNoIslandRepCount'] = 0

local flow Sub_Event34():
    MainNpc.SetItemName(1, 0, 0)
    MainNpc.SetDeliveryItem(1, true)
    MainNpc.NpcDelivery(1, 'Keep')
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachE_MainSeq:114_01', true)
    run Sub_Event28()

