flow Enter():
    fork:
        branch:
            Player.TurnNeck(1, false)
        branch:
            MainNpc.TurnNeck(1, false)
            MainNpc.CharacterEmoticonAction('EmotEnd', true, '', 0, false)
        branch:
            SubNpc.TurnNeck(11, false)
            SubNpc.NpcMoveDirection(201.0, 10.0, 0, false, false)
            SubNpc.CharacterEmoticonAction('Shocked', true, '', 0, false)
            EventFlowSystemActor.WaitFrame(20)

flow Exit(RoomSize_Depth: int):
    MainNpc.TurnNeck(1, false)
    EventFlowSystemActor.WaitFrame(12)
    SubNpc.TurnNeck(0, false)
    fork:
        branch:
            MainNpc.CharacterEmoticonAction('Greeting', true, '', 0, false)
        branch:
            EventFlowSystemActor.WaitFrame(20)
            SubNpc.CharacterEmoticonAction('FaintSmile', true, '', 0, false)
    EventFlowSystemActor.WaitFrame(20)
    MainNpc.NpcChangeWaitState('cWait', '', '', '', false, true, ArgFlag0=true, ArgInt0=0, ArgStr0='')
    MainNpc.TurnNeck(11, false)
    if RoomSize_Depth <= 4:
        MainNpc.NpcRailMove(0, false, false, 0, 0, 1)
    elif RoomSize_Depth <= 6:
        MainNpc.NpcRailMove(1, false, false, 0, 0, 1)
    elif RoomSize_Depth > 8:
        MainNpc.NpcRailMove(3, false, false, 0, 0, 1)
    else:
        MainNpc.NpcRailMove(2, false, false, 0, 0, 1)

flow Root():
    MainNpc.NpcAISetting(9, true)
    run Enter()
    EventFlowSystemActor.CameraSetDemoParam('EntranceTalk_EventFtrWall', 'EntranceTalk_EventFtrWall', 'Place:SafeArea', false, false, false, 0)
    SubNpc.OpenMessageWindow('TalkNNpc/B1_Bo/OneRoom/BO_WherearenEvent_Once:051', true)
    fork:
        branch:
            MainNpc.OpenMessageWindow('TalkSNpc/mnc/SP_mnc_04_WherearenEvent:141', true)
        branch:
            EventFlowSystemActor.WaitFrame(15)
            SubNpc.TurnBody(0, 0.0)
    SubNpc.OpenMessageWindow('TalkNNpc/B1_Bo/OneRoom/BO_WherearenEvent_Once:052', true)
    MainNpc.OpenMessageWindow('TalkSNpc/mnc/SP_mnc_04_WherearenEvent:142', true)
    SubNpc.CharacterEmoticonAction('FaintSmile', true, '', 0, false)
    EventFlowSystemActor.WaitFrame(30)
    SubNpc.CharacterEmoticonAction('EmotEnd', true, '', 0, false)
    MainNpc.TurnBody(10, 0.0)
    EventFlowSystemActor.WaitFrame(12)
    Player.TurnNeck(0, false)
    fork:
        branch:
            MainNpc.OpenMessageWindow('TalkSNpc/mnc/SP_mnc_04_WherearenEvent:143', false)
        branch:
            EventFlowSystemActor.WaitFrame(20)
            SubNpc.TurnNeck(10, false)
    MainNpc.OpenMessageWindow('TalkSNpc/mnc/SP_mnc_04_WherearenEvent:144', true)
    run `00_Demo_Fade`::FadeOut_Cmn(FadeType='cCircle', FadeColor='cBlack', FadeSpeed='cNormal', SoundDucking='cWorldDucking')
    MainNpc.NpcSetVisibleAction(false)
    Player.TurnNeck(11, false)
    EventFlowSystemActor.WaitFrame(20)
    run `00_Demo_Fade`::FadeIn_Cmn(IsWait=true)
    System.EventFlags['cWherearenPlayer:Unlock_Kabetasu'] = true
    System.EventFlags['cWherearenPlayer:SeqKabetasuEventReady'] = false

flow Root_Init():
    MainNpc.NpcAISetting(2, false)
    MainNpc.NpcAISetting(3, false)
    MainNpc.NpcAISetting(5, false)
    MainNpc.NpcAISetting(9, false)
    MainNpc.WherearenCustomerEntrySubCast(1, false, false, false, false, false)

