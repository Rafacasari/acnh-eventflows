flow BoaFreeTalk():
    if EventFlowSystemActor.PercentChoice(50):
        MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:103', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:104', false)

flow BoaTurnipTalk():
    switch EventFlowSystemActor.PercentChoice3(50, 30, 20):
        case 0:
            MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:105_01', false)
entrypoint Event9:
            MainNpc.SetDeliveryItemAtRandom(2634, true, 'cVillageRemakePattern', 0)
            MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:106_01', false)
            MainNpc.NpcDelivery(1, 'Default')
        case 1:
            MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:105_01', false)
entrypoint Event5:
            MainNpc.SetDeliveryItemAtRandom(2636, true, 'cVillageRemakePattern', 0)
            MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:106_02', false)
            MainNpc.NpcDelivery(1, 'Default')
        case 2:
            MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:105_02', false)
entrypoint Event11:
            MainNpc.SetDeliveryItemAtRandom(2641, true, 'cVillageRemakePattern', 0)
            MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:106_03', false)
            MainNpc.NpcDelivery(1, 'Default')
    MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:107', true)
    System.EventFlags['cWherearenPlayer:BoaGetTurnipToday'] = true
    System.EventFlags['cWherearenPlayer:BoaGiveTurnipFailed'] = false

flow BoaTurnipTalk_100():
    run Event11()

flow BoaTurnipTalk_30():
    run Event9()

flow BoaTurnipTalk_50():
    run Event5()

flow Root():
    run Walk()

flow Sit():
    run Walk()

local flow Sub_Event30():
    System.EventFlags['cWherearenPlayer:BoaTalkToday'] = true
    if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1:
        MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:108', false)
        System.EventFlags['cWherearenPlayer:BoaGiveTurnipFailed'] = true
    elif MainNpc.NpcIsSitting() == 4:
        run BoaTurnipTalk()
        System.EventFlags['cWherearenPlayer:BoaGetTurnipToday'] = true

flow Walk():
    if System.EventFlags['cWherearenPlayer:BoaGiveTurnipFailed']:
        if MainNpc.NpcIsSitting() in (0, 1, 2, 3, 5):
            run BoaFreeTalk()
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:109', false)
            if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1:
                MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:110', false)
            else:
                switch EventFlowSystemActor.PercentChoice3(50, 30, 20):
                    case 0:
                        run BoaTurnipTalk_30()
                    case 1:
                        run BoaTurnipTalk_50()
                    case 2:
                        run BoaTurnipTalk_100()
    elif not System.EventFlags['cWherearenPlayer:BoaTalkedWherearen']:
        System.EventFlags['cWherearenPlayer:BoaTalkedWherearen'] = true
        MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:101', false)
        run Sub_Event30()
    elif System.EventFlags['cWherearenPlayer:BoaTalkToday']:
        if System.EventFlags['cWherearenPlayer:BoaGetTurnipToday']:
            run BoaFreeTalk()
        else:
            if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1:
                MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:108', false)
                System.EventFlags['cWherearenPlayer:BoaGiveTurnipFailed'] = true
            elif MainNpc.NpcIsSitting() in (0, 1, 2, 3, 5):
                run BoaFreeTalk()
            else:
                run BoaTurnipTalk()
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/boa/SP_boa_WherearenEvent:102', false)
        run Sub_Event30()

