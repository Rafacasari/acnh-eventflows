flow Art():
    if EventFlowSystemActor.MultiKindItemSelectInclude('Sculpture', 'Picture', '', '', '', '', '', '', 'cItemSelect'):
        run Real_Art()
    else:
        run Real_Art()

flow Bouquet_Chk():
    if EventFlowSystemActor.MultiItemSelectInclude(14029, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
        MainNpc.RegistValentinePresentInfo()

flow Dish_Food_Drink():
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:421', false)
    MainNpc.NpcDelivery(3, '"Default"')
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:422', false)
    MainNpc.NpcAddFriendship(3)
    MainNpc.NpcSetShowFlag()

flow Fossil():
    if not EventFlowSystemActor.MultiKindItemSelectInclude('Fossil', '', '', '', '', '', '', '', 'cItemSelect'):
        if System.EventFlags['cLand:MuseumBuilt']:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_General:002', false)
            MainNpc.NpcDelivery(3, '"Default"')
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:112', false)
            MainNpc.NpcAddFriendship(1)
        else:
            run No_Museum()
    elif not System.EventFlags['cLand:MuseumBuilt']:
        run No_Museum()
    elif MainNpc.OwlIsDonation('cDeliveryItem'):
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_General:002', false)
        MainNpc.NpcDelivery(3, '"Default"')
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:111', false)
        MainNpc.NpcAddFriendship(1)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:113', false)
        MainNpc.NpcDelivery(10, 'Default')
        EventFlowSystemActor.ExitFlowchart()

flow Furniture():
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_General:001', false)
    if MainNpc.IsNpcPlayerRelativeItem() != 0:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:104', false)
    MainNpc.NpcDelivery(3, '"Default"')
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:100', false)
    if EventFlowSystemActor.MultiMessageCategoryItemSelectInclude('DecorateFtr', '', '', '', '', '', '', '', 'cItemSelect'):
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:101', false)
    else:
        if EventFlowSystemActor.MultiKindItemSelectInclude('DoorDeco', '', '', '', '', '', '', '', 'cItemSelect'):
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:102', false)
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:103', false)
    MainNpc.NpcAddFriendship(3)
    MainNpc.NpcSetShowFlag()

flow No_Art():
    run Event47()

flow No_Museum():
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_General:002', false)
    MainNpc.NpcDelivery(3, '"Default"')
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:114', false)
    MainNpc.NpcAddFriendship(1)

flow Opposite_Sex():
    run ValentineItem_Chk()
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:514', false)
    MainNpc.NpcDelivery(3, '"Default"')
    EventFlowSystemActor.SystemDeletePlayerItem('cItemWindowSub', 1)
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:515', false)
    MainNpc.NpcAddFriendship(2)
    run Bouquet_Chk()

flow Real_Art():
    if not System.EventFlags['cLand:Museum3Built']:
entrypoint Event47:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:122', false)
        run Sub_Event41()
    elif MainNpc.OwlIsDonation('cDeliveryItem'):
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_General:002', false)
        MainNpc.NpcDelivery(3, '"Default"')
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:121', false)
        MainNpc.NpcAddFriendship(1)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:123', false)
        run Sub_Event41()

flow Same_Sex():
    run ValentineItem_Chk()
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:516', false)
    MainNpc.NpcDelivery(3, '"Default"')
    EventFlowSystemActor.SystemDeletePlayerItem('cItemWindowSub', 1)
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Select/BO_Select_Present:517', false)
    MainNpc.NpcAddFriendship(2)
    run Bouquet_Chk()

local flow Sub_Event41():
    MainNpc.NpcDelivery(10, 'Default')
    EventFlowSystemActor.ExitFlowchart()

flow ValentineItem_Chk():
    if EventFlowSystemActor.MultiItemSelectInclude(14029, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
        MainNpc.SetDeliveryItemAtRandom(14029, false, 'cVillageRemakePattern', 0)
    else:
        MainNpc.SetDeliveryItemAtRandom(13488, false, 'cVillageRemakePattern', 0)

flow ValentinePresent():
    if EventFlowSystemActor.PlayerGender() == 0:
        if MainNpc.CheckNpcLook() in (0, 1, 2, 3):
            run Opposite_Sex()
        else:
            run Same_Sex()
    elif MainNpc.CheckNpcLook() in (0, 1, 2, 3):
        run Same_Sex()
    else:
        run Opposite_Sex()

