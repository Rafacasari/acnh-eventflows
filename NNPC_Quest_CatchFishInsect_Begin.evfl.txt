flow Begin():
    MainNpc.NpcDecideCatchRequestItem()
    switch MainNpc.NpcCheckCatchQuestType():
        case 0:
            run InsectNormal()
        case 1:
            run InsectRare()
        case 2:
            run FishNormal()
        case 3:
            run FishRare()

flow Begin_Ap():
    MainNpc.NpcDecideCatchRequestItem()
    switch MainNpc.NpcCheckCatchQuestType():
        case 0, 2:
            run NNPC_Approach::Reselection()
        case 1:
            MainNpc.SetItemName(0, 2, 0)
            if MainNpc.CheckNpcApproachType():
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:101', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    MainNpc.QuestStartOpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:103', false, false)
                    run Sub_Event126()
                else:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:104', false)
                    MainNpc.NpcQuestControl('cFinish')
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:102', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    MainNpc.QuestStartOpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:105', false, false)
                    run Sub_Event126()
                else:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:106', false)
                    MainNpc.NpcQuestControl('cFinish')
        case 3:
            MainNpc.SetItemName(0, 3, 0)
            if MainNpc.CheckNpcApproachType():
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:201', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    MainNpc.QuestStartOpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:203', false, false)
                    run Sub_Event59()
                else:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:204', false)
                    MainNpc.NpcQuestControl('cFinish')
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:202', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    MainNpc.QuestStartOpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:205', false, false)
                    run Sub_Event59()
                else:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:206', false)
                    MainNpc.NpcQuestControl('cFinish')

flow FishNormal():
    MainNpc.SetItemName(0, 3, 0)
    if MainNpc.NpcCatchQuestFishNormalType() == 0:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:031', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Normal_Yes()
        else:
            run Normal_No()
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:032', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Normal_Yes()
        else:
            run Normal_No()

flow FishRare():
    MainNpc.SetItemName(0, 3, 0)
    if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:008', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Rare_Yes()
        else:
            run Rare_No()
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:009', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Rare_Yes()
        else:
            run Rare_No()

flow InsectNormal():
    MainNpc.SetItemName(0, 2, 0)
    switch MainNpc.NpcCatchQuestInsectNormalType():
        case 0:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:021', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Normal_Yes()
            else:
                run Normal_No()
        case 1:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:022', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Normal_Yes()
            else:
                run Normal_No()
        case 2:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:023', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Normal_Yes()
            else:
                run Normal_No()
        case 3:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:025', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Normal_Yes()
            else:
                run Normal_No()
        case 4:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:026', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Normal_Yes()
            else:
                run Normal_No()
        case 5:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:027', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Normal_Yes()
            else:
                run Normal_No()
        case 6:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:028', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Normal_Yes()
            else:
                run Normal_No()

flow InsectRare():
    MainNpc.SetItemName(0, 2, 0)
    if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:003', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Rare_Yes()
        else:
            run Rare_No()
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:004', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Rare_Yes()
        else:
            run Rare_No()

flow Normal_No():
    if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:015', false)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:016', false)
    MainNpc.NpcQuestControl('cFinish')

flow Normal_Yes():
    if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        MainNpc.QuestStartOpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:011', false, false)
    else:
        MainNpc.QuestStartOpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:012', false, false)
    MainNpc.NpcQuestControl('cStart')
    MainNpc.EventFlags['cNpcMemory:OrderQuest'] = true

flow Rare_No():
    if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:017', false)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:018', false)
    MainNpc.NpcQuestControl('cFinish')

flow Rare_Yes():
    if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        MainNpc.QuestStartOpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:013', false, false)
    else:
        MainNpc.QuestStartOpenMessageWindow('TalkNNpc/B1_Bo/Quest/BO_Quest_CatchFishInsect_Begin:014', false, false)
    MainNpc.NpcQuestControl('cStart')
    MainNpc.EventFlags['cNpcMemory:OrderQuest'] = true

local flow Sub_Event126():
    MainNpc.NpcQuestControl('cStart')
    MainNpc.EventFlags['cNpcMemory:ApproachQuestOrdered'] = true
    MainNpc.EventFlags['cNpcMemory:OrderQuest'] = true

local flow Sub_Event59():
    MainNpc.NpcQuestControl('cStart')
    MainNpc.EventFlags['cNpcMemory:ApproachQuestOrdered'] = true
    MainNpc.EventFlags['cNpcMemory:OrderQuest'] = true

