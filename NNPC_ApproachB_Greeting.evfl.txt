flow Cancell():
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:104', true)
    run Event27()

flow Retype():
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:103', true)
    run Event27()

flow Root():
    if MainNpc.CheckNpcApproachType():
        if MainNpc.EventFlags['cNpcMemory:InputGreeting']:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:002', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Sub_Event11()
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:006', false)
                System.EventFlags['cPlayer:InputApproachBanCount'] = 2
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:001', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Sub_Event11()
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:005', false)
                System.EventFlags['cPlayer:InputApproachBanCount'] = 2
    elif MainNpc.EventFlags['cNpcMemory:InputGreeting']:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:004', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Sub_Event11()
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:008', false)
            System.EventFlags['cPlayer:InputApproachBanCount'] = 2
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:003', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Sub_Event11()
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:007', false)
            System.EventFlags['cPlayer:InputApproachBanCount'] = 2

local flow Sub_Event11():
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:100', true)
entrypoint Event27:
    EventFlowSystemActor.UISoftwareKeyboardHandling('cGreeting', true)
    if EventFlowSystemActor.UIResultMenuDecide():
        EventFlowSystemActor.SetTagFromUIResult('cGreeting', 0)
        if MainNpc.NpcCheckSameWordFromSwkbd('cGreeting'):
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:102', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, true):
                    case 0:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:300', false)
                    case 1:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:301', false)
                    case 2:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:302', false)
                EventFlowSystemActor.SaveSetFromUIResult('cGreeting')
                MainNpc.EventFlags['cNpcMemory:InputGreeting'] = true
                System.EventFlags['cPlayer:InputApproachBanCount'] = 1
            else:
                run Retype()
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:101', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:200', false)
                else:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:201', false)
                EventFlowSystemActor.SaveSetFromUIResult('cGreeting')
                MainNpc.EventFlags['cNpcMemory:InputGreeting'] = true
                switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, true):
                    case 0:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:202', false)
                    case 1:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:203', false)
                    case 2:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Approach/BO_ApproachB_Greeting:204', false)
                System.EventFlags['cPlayer:InputApproachBanCount'] = 1
            else:
                run Retype()
    else:
        run Cancell()

