flow Prologue_NnpcTentChk():
    if System.EventFlags['cLand:Prologue4BuiltNpcHA']:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:008_02', true)
        Player.TurnNeck(11, false)
        EventFlowSystemActor.WaitFrame(10)
        EventFlowSystemActor.SetNpcAIBlackBoardByLabel('rco', 'isSpeak', 1, 1)
    elif System.EventFlags['cPlayer:Prologue4HaGetTent']:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:025_02', false)
    else:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:008_03', false)

flow Root():
    MainNpc.SetNpcName(13, 0)
    if not System.EventFlags['cPlayer:PrologueDone1stTalkAtPlaza']:
        if MainNpc.NpcBlackBoard('ArrivePlaza', 1):
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:002', false)
        else:
            switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, false):
                case 0:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:000_01', false)
                case 1:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:000_02', false)
                case 2:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:000_03', false)
    elif System.EventFlags['cPlayer:PrologueStartedCampfire']:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:101', false)
    elif System.EventFlags['cPlayer:PrologueAfterBuiltTentTalk']:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:001', false)
    elif System.EventFlags['cLand:Prologue4BuiltNpcAN']:
        if not System.EventFlags['cPlayer:Prologue4AnGetTent']:
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:021', false)
        elif System.EventFlags['cPlayer:Prologue4AnBuiltTent']:
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:024', false)
            if System.EventFlags['cPlayer:Prologue4HaGetTent']:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:025_02', false)
            else:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:025_01', false)
        else:
            System.EventFlags['cPlayer:Prologue4AnBuiltTent'] = true
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:022', false)
            switch EventFlowSystemActor.GeneralTalkChoice2():
                case 0, 1:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:023', false)
                    run Prologue_NnpcTentChk()
    elif System.EventFlags['cPlayer:Prologue4AnGetTent']:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:013', false)
    else:
        if not MainNpc.EventFlags['cNpcMemory:FirstMeetGreetAtThisVillage']:
            MainNpc.EventFlags['cNpcMemory:FirstMeetGreetAtThisVillage'] = true
            MainNpc.EventFlags['cNpcMemory:FirstMeetGreetAtThisVillageToday'] = true
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:001', false)
        if not System.EventFlags['cPlayer:PlayerPocketUIEnable']:
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:002', false)
        elif System.EventFlags['cLand:Prologue4BuiltPlayer']:
            if System.EventFlags['cPlayer:Prologue4AnNoTent']:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:014', false)
            else:
                System.EventFlags['cPlayer:Prologue4AnNoTent'] = true
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:004', false)
            MainNpc.SetDeliveryItem(3, true)
            switch EventFlowSystemActor.GeneralTalkChoice3():
                case 0:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:005', true)
                    run System_Structure_Common::PreviewStructure(StructurePosType='cNpc', StructureType='cNormalNpcHouse', BuildTiming='cNew')
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:006', false)
                    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:007', true)
                        run System_Structure_Common::DeletePreviewAndBuildStructureInNpcTalk(StructurePosType='cNpc', StructureType='cNormalNpcHouse', BuildTiming='cNew')
                        MainNpc.SetItemName(3, 0, 0)
                        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:008_01', false)
                        System.EventFlags['cLand:Prologue4BuiltNpcAN'] = true
                        run Prologue_NnpcTentChk()
                    else:
                        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:010', true)
                        run System_Structure_Common::DeletePreviewStructureInNpcTalk(StructurePosType='cNpc', StructureType='cNormalNpcHouse')
                case 1:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:011', true)
                    MainNpc.NpcDelivery(1, 'Keep')
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:012', false)
                    MainNpc.NpcDelivery(2, '"Default"')
                    System.EventFlags['cPlayer:Prologue4AnGetTent'] = true
                    MainNpc.NpcSetAIBlackBoard('HasTent', 0)
                    MainNpc.NpcSetAIBlackBoard('BuildingSiteIndex', -1)
                case 2:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:009', false)
        else:
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:003', false)

