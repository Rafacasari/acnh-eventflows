flow WebSetting_Activate():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.CheckFreeCommunication(true)
    if EventFlowSystemActor.IsApprovedFreeCommunication():
        EventFlowSystemActor.MessageLockNext(1)
        EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_Network:030', false)
        if EventFlowSystemActor.NetMode() not in (0, 2):
            EventFlowSystemActor.NetShutdown('cNetShutdown', false)
        EventFlowSystemActor.NetConnectInit('cConnectInet', true)
        if EventFlowSystemActor.CheckErrorType(2):
            run WebSetting_Activate_Failed()
        else:
            EventFlowSystemActor.NetCheckNSA('cCheckNSA', true)
            if EventFlowSystemActor.CheckErrorType(2):
                run WebSetting_Activate_Failed()
            else:
                EventFlowSystemActor.NetGetPOPID(true)
                if EventFlowSystemActor.CheckErrorType(2):
                    run WebSetting_Activate_Failed()
                else:
                    EventFlowSystemActor.UploadProfile(false, true)
                    if EventFlowSystemActor.CheckErrorType(2):
                        if EventFlowSystemActor.NetIsAppError('cUploadProfile'):
                            EventFlowSystemActor.MessageSuspend()
                            EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:0820', true)
                        run WebSetting_Activate_Failed()
                    else:
                        EventFlowSystemActor.NetUploadEmoticon(false, -1, false)
                        if EventFlowSystemActor.CheckErrorType(2):
                            run WebSetting_Activate_Failed()
                        else:
                            EventFlowSystemActor.NetUploadCatalog(true, false)
                            if EventFlowSystemActor.CheckErrorType(2):
                                run WebSetting_Activate_Failed()
                            else:
                                EventFlowSystemActor.NetUploadRewardUnlock(false, false)
                                if EventFlowSystemActor.CheckErrorType(2):
                                    run WebSetting_Activate_Failed()
                                else:
                                    EventFlowSystemActor.NetUploadResortUnlock(false, false)
                                    if EventFlowSystemActor.CheckErrorType(2):
                                        run WebSetting_Activate_Failed()
                                    else:
                                        EventFlowSystemActor.NetUploadLifeTips(false, false)
                                        if EventFlowSystemActor.CheckErrorType(2):
                                            run WebSetting_Activate_Failed()
                                        else:
                                            EventFlowSystemActor.NetUploadPlayerMemories(false, false)
                                            if EventFlowSystemActor.CheckErrorType(2):
                                                run WebSetting_Activate_Failed()
                                            else:
                                                run WebSetting_Activate_Core()
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:151', true)
        run SNPC_rco_92_OtherSettings::Seq_Close()

flow WebSetting_Activate_Core():
    EventFlowSystemActor.NotifyUseNSOAppli('cNotifyUseNSOAppli', true)
    if EventFlowSystemActor.CheckErrorType(2):
        run WebSetting_Activate_Failed()
    else:
        EventFlowSystemActor.MessageSuspend()
        run WebSetting_Activate_Success()

flow WebSetting_Activate_Failed():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.MessageUnlockNext()
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:150', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run WebSetting_Activate()
    else:
        run SNPC_rco_92_OtherSettings::Sel_EndMenu()

flow WebSetting_Activate_Success():
    System.EventFlags['cPlayer:Activate_WebService'] = true
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_Save:001', false)
    EventFlowSystemActor.SaveSimpleSave('cAll')
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.MessageUnlockNext()
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:100', false)
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:120', false)
    run SNPC_rco_92_OtherSettings::Seq_Close()

flow WebSetting_DataUpload():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.CheckFreeCommunication(true)
    if EventFlowSystemActor.IsApprovedFreeCommunication():
        EventFlowSystemActor.MessageLockNext(1)
        EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_Network:031', false)
        if EventFlowSystemActor.NetMode() not in (0, 2):
            EventFlowSystemActor.NetShutdown('cNetShutdown', false)
        EventFlowSystemActor.NetConnectInit('cConnectInet', true)
        if EventFlowSystemActor.CheckErrorType(2):
            run WebSetting_Upload_Failed()
        else:
            EventFlowSystemActor.NetCheckNSA('cCheckNSA', true)
            if EventFlowSystemActor.CheckErrorType(2):
                run WebSetting_Upload_Failed()
            else:
                EventFlowSystemActor.NetGetPOPID(true)
                if EventFlowSystemActor.CheckErrorType(2):
                    run WebSetting_Upload_Failed()
                else:
                    EventFlowSystemActor.UploadProfile(false, true)
                    if EventFlowSystemActor.CheckErrorType(2):
                        if EventFlowSystemActor.NetIsAppError('cUploadProfile'):
                            EventFlowSystemActor.MessageSuspend()
                            EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:0820', true)
                        run WebSetting_Upload_Failed()
                    else:
                        EventFlowSystemActor.NetUploadEmoticon(false, -1, false)
                        if EventFlowSystemActor.CheckErrorType(2):
                            run WebSetting_Upload_Failed()
                        else:
                            EventFlowSystemActor.NetUploadCatalog(true, false)
                            if EventFlowSystemActor.CheckErrorType(2):
                                run WebSetting_Upload_Failed()
                            else:
                                EventFlowSystemActor.NetUploadRewardUnlock(false, false)
                                if EventFlowSystemActor.CheckErrorType(2):
                                    run WebSetting_Upload_Failed()
                                else:
                                    EventFlowSystemActor.NetUploadResortUnlock(true, false)
                                    if EventFlowSystemActor.CheckErrorType(2):
                                        run WebSetting_Upload_Failed()
                                    else:
                                        EventFlowSystemActor.NetUploadLifeTips(true, false)
                                        if EventFlowSystemActor.CheckErrorType(2):
                                            run WebSetting_Upload_Failed()
                                        else:
                                            EventFlowSystemActor.NetUploadPlayerMemories(false, false)
                                            if EventFlowSystemActor.CheckErrorType(2):
                                                run WebSetting_Upload_Failed()
                                            else:
                                                run WebSetting_Upload_Success()
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:151', true)
        run SNPC_rco_92_OtherSettings::Seq_Close()

flow WebSetting_Explain():
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:200', false)
    if System.EventFlags['cPlayer:Activate_WebService']:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:021', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run WebSetting_Explain()
        else:
            run SNPC_rco_92_OtherSettings::Sel_EndMenu()
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:020', false)
        switch EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                run WebSetting_Activate()
            case 1:
                run WebSetting_Explain()
            case 2:
                run SNPC_rco_92_OtherSettings::Sel_EndMenu()

flow WebSetting_Main():
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:001', false)
    if System.EventFlags['cPlayer:Activate_WebService']:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:016', false)
        switch EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                run WebSetting_Explain()
            case 1:
                run WebSetting_UploadConfirm()
            case 2:
                run SNPC_rco_92_OtherSettings::Sel_EndMenu()
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:010', false)
        switch EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                run WebSetting_Activate()
            case 1:
                run WebSetting_Explain()
            case 2:
                run SNPC_rco_92_OtherSettings::Sel_EndMenu()

flow WebSetting_UploadConfirm():
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:160', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run WebSetting_DataUpload()
    else:
        run SNPC_rco_92_OtherSettings::Sel_EndMenu()

flow WebSetting_Upload_Failed():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.MessageUnlockNext()
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:150', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run WebSetting_DataUpload()
    else:
        run SNPC_rco_92_OtherSettings::Sel_EndMenu()

flow WebSetting_Upload_Success():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.MessageUnlockNext()
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:161', false)
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:120', false)
    run SNPC_rco_92_OtherSettings::Seq_Close()

