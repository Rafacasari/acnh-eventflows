flow Follow():
    EventFlowSystemActor.NetWherearenAddFollowList('cInspect')
    if EventFlowSystemActor.CheckErrorType(2):
        switch EventFlowSystemActor.NetWherearenAddFollowFailReason():
            case 0:
                SubflowResults[0] = 1
            case 1:
                SubflowResults[0] = 2
            case 2:
                SubflowResults[0] = 3
    else:
        SubflowResults[0] = 0

flow ForceTalk():
    MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:000', false)
    System.EventFlags['cPlayerTemp:WHEREAREN_ManTalkReserve_Inspect'] = false
    run InspectRewards()
    EventFlowSystemActor.StartMeasurePlayTime('cWherearenInspect')

flow InspectRewards():
    if (not EventFlowSystemActor.NetWherearenIsMyOpusData()) and (System.EventFlags['cPlayer:WHEREAREN_GetInspectRewardsNum'] < 3):
        if System.EventFlags['cPlayer:WHEREAREN_GetInspectRewardsNum'] == 0:
            if EventFlowSystemActor.NetWherearenIsGetInspectReward('cBronze'):
                MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:040', false)
                System.EventFlags['cPlayer:WHEREAREN_GetInspectRewardsNum'] = 1
        elif System.EventFlags['cPlayer:WHEREAREN_GetInspectRewardsNum'] == 1:
            if EventFlowSystemActor.NetWherearenIsGetInspectReward('cSilver'):
                MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:041', false)
                System.EventFlags['cPlayer:WHEREAREN_GetInspectRewardsNum'] = 2
        elif (System.EventFlags['cPlayer:WHEREAREN_GetInspectRewardsNum'] == 2) and (EventFlowSystemActor.NetWherearenIsGetInspectReward('cGold')):
            MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:042', false)
            System.EventFlags['cPlayer:WHEREAREN_GetInspectRewardsNum'] = 3

flow Leave():
    run Root()

flow MyDesignShowCase():
    EventFlowSystemActor.SetTagFromSystem('cWherearenInspectOwnerName', 'cDegit', 0, 0, '')
    if System.EventFlags['cPlayer:WHEREAREN_TapFirstCheckMydesingShowcase']:
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:045', false)
    else:
        System.EventFlags['cPlayer:WHEREAREN_TapFirstCheckMydesingShowcase'] = true
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:044', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run Obj_WorldMyDesignGallery::EntryPoint_NoSignInNo()
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:002', false)

flow Report():
    EventFlowSystemActor.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:021', false)

flow Return():
    MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:010', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:011', true)
        EventFlowSystemActor.StopMeasurePlayTime('cWherearenInspect')
        EventFlowSystemActor.PlayReport('cWherearenInspect', 0)
        if EventFlowSystemActor.CheckMeasuredPlayTime('cWherearenInspect', 20):
            System.EventFlags['cPlayerTemp:WHEREAREN_NeedsInspectReply'] = true
        run System_WherearenResortPlanner::Setting_ReturnInspect()
        EventFlowSystemActor.SystemRequestChangeStage('cWherearenPlannerApp', 'cWherearenInspectBack', 'cWherearenInspectBack', 'cBlack', 1.0, 1.0)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:012', false)

flow Root():
    if EventFlowSystemActor.NetWherearenIsMyOpusData():
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:001_01', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run Return()
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:002', false)
    elif EventFlowSystemActor.NetWherearenCanOpenMyDesign():
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:001', false)
        switch EventFlowSystemActor.GeneralTalkChoice5():
            case 0:
                run Return()
            case 1:
                run Sub_Event30()
            case 2:
                run MyDesignShowCase()
            case 3:
                run Report()
            case 4:
                MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:002', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:001_02', false)
        switch EventFlowSystemActor.GeneralTalkChoice4():
            case 0:
                run Return()
            case 1:
                run Sub_Event30()
            case 2:
                run Report()
            case 3:
                MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:002', false)

local flow Sub_Event30():
    EventFlowSystemActor.SetTagFromSystem('cWherearenInspectOwnerName', 'cDegit', 0, 0, '')
    if EventFlowSystemActor.NetWherearenIsFollowedAuthor():
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:030', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:031', true)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            EventFlowSystemActor.MessageLockNext(1)
            EventFlowSystemActor.MessageAutoPass(1, true)
            MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:046', false)
            run Follow()
            EventFlowSystemActor.MessageUnlockNext()
            switch SubflowResults@4[0]:
                case 0:
                    MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:033', false)
                    System.EventFlags['cPlayerTemp:WHEREAREN_ResortPlanner_IsFollowUpdated'] = true
                case 1:
                    MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:034', false)
                case 2:
                    MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:030', false)
                case 3:
                    MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:035', false)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/man/SP_man_03_WherearenInspect:032', false)

