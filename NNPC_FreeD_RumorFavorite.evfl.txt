flow Input():
    switch EventFlowSystemActor.GeneralTalkChoice5():
        case 0, 1, 2:
            run Sub_grp_Event38()
        case 3:
entrypoint Event53:
            EventFlowSystemActor.UISoftwareKeyboardHandling('cTaste', true)
            EventFlowSystemActor.SetTagFromUIResult('cRumorFavorite', 0)
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:051', false)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                run Sub_grp_Event38()
            else:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:052', false)
                run Event53()
        case 4:
            if MainNpc.NpcRumorIsSelectedAllDeny():
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:061', false)
            else:
                MainNpc.NpcRumorOpenMessage('107', 'cTopic')
                MainNpc.NpcRumorSaveAnswer()
            run NNPC_FreeD::RumorP_Favorite_End()
            return

flow RumorOP_Favorite_Host():
    MainNpc.NpcRumorDecidePlayer('cHostPlayer')
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:101', false)
    if EventFlowSystemActor.GeneralTalkChoice2() != 0:
        if MainNpc.NpcRumorIsExistAnswerTopic():
            MainNpc.NpcRumorDecideTopic('cAnswerRandom')
            MainNpc.NpcRumorTagSet()
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:160', false)
            if MainNpc.NpcRumorIsSelectedAllDeny():
                MainNpc.NpcRumorOpenMessage('180', 'cTopic')
            else:
                MainNpc.NpcRumorOpenMessage('170', 'cCategory')
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:150', false)
    elif MainNpc.NpcRumorIsExistAnswerTopic():
        MainNpc.NpcRumorDecideTopic('cAnswerRandom')
        MainNpc.NpcRumorTagSet()
        if MainNpc.NpcRumorIsSelectedAllDeny():
            MainNpc.NpcRumorOpenMessage('120', 'cTopic')
        else:
            MainNpc.NpcRumorOpenMessage('110', 'cCategory')
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:130', false)
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:131', false)
    else:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:102', false)

flow RumorOP_Favorite_Villager():
    MainNpc.NpcRumorDecidePlayer('cRandom')
    MainNpc.NpcRumorDecideTopic('cAllRandom')
    if MainNpc.NpcRumorIsAnsweredTargetTopic():
        MainNpc.NpcRumorTagSet()
        if MainNpc.NpcRumorIsSelectedAllDeny():
            MainNpc.NpcRumorOpenMessage('010', 'cTopic')
        else:
            MainNpc.NpcRumorOpenMessage('001', 'cCategory')
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:020', false)
        elif MainNpc.NpcRumorIsAskedOwn():
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:021', false)
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:022', false)
    else:
        MainNpc.NpcRumorOpenMessage('050', 'cCategory')
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorOP_Favorite:051', false)
        else:
            MainNpc.NpcRumorOpenMessage('060', 'cTopic')

flow RumorP_Favorite_CurrentPlayer():
    MainNpc.NpcRumorDecidePlayer('cCurrentPlayer')
    MainNpc.NpcRumorDecideTopic('cAllRandom')
    if not MainNpc.NpcRumorIsAnsweredTargetTopic():
        if MainNpc.NpcCheckMoveInBeforePlayer():
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:001', false)
        else:
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:002', false)
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:003', false)
        MainNpc.NpcRumorOpenMessage('100', 'cTopic')
        run Input()
    elif (not MainNpc.NpcRumorIsSelectedAllDeny()) or (MainNpc.NpcRumorCheckAllDenyProgressDays(30)):
        MainNpc.NpcRumorTagSet()
        if not MainNpc.NpcRumorIsAskedOwn():
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:020', false)
            if MainNpc.NpcRumorIsSelectedAllDeny():
                MainNpc.NpcRumorOpenMessage('040', 'cTopic')
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:041', false)
                    MainNpc.NpcRumorResetLastDenyTime()
                    run NNPC_FreeD::RumorP_Favorite_End()
                else:
                    run Sub_Event26()
            else:
                MainNpc.NpcRumorOpenMessage('030', 'cCategory')
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    if MainNpc.NpcRumorIsEqualNpcChoice('cPrev') in (0, 1, 2):
                        MainNpc.NpcRumorOpenMessage('031', 'cCategory')
                    else:
                        MainNpc.NpcRumorOpenMessage('032', 'cCategory')
                    run NNPC_FreeD::RumorP_Favorite_End()
                else:
                    run Sub_Event26()
        elif not MainNpc.NpcRumorIsSelectedAllDeny():
            MainNpc.NpcRumorOpenMessage('010', 'cCategory')
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                MainNpc.NpcRumorOpenMessage('011', 'cCategory')
                run NNPC_FreeD::RumorP_Favorite_End()
            else:
                MainNpc.NpcRumorOpenMessage('101', 'cTopic')
                run Input()

local flow Sub_Event26():
    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeD_RumorP_Favorite:049', false)
    MainNpc.NpcRumorOpenMessage('102', 'cTopic')
    run Input()

local flow Sub_grp_Event38():
    if MainNpc.NpcRumorIsEqualPreviousChoice():
        MainNpc.NpcRumorOpenMessage('060', 'cCategory')
        if MainNpc.NpcRumorIsAskedOwn():
            MainNpc.NpcRumorOpenMessage('011', 'cCategory')
        else:
            if MainNpc.NpcRumorIsEqualNpcChoice('cCurrent') in (0, 1, 2):
                MainNpc.NpcRumorOpenMessage('031', 'cCategory')
            else:
                MainNpc.NpcRumorOpenMessage('032', 'cCategory')
        run NNPC_FreeD::RumorP_Favorite_End()
    else:
        switch MainNpc.NpcRumorIsEqualNpcChoice('cCurrent'):
            case 0:
                MainNpc.NpcRumorOpenMessage('103', 'cTopic')
            case 1:
                MainNpc.NpcRumorOpenMessage('104', 'cTopic')
            case 2:
                MainNpc.NpcRumorOpenMessage('105', 'cTopic')
            case 3:
                MainNpc.NpcRumorOpenMessage('106', 'cTopic')
        MainNpc.NpcRumorSaveAnswer()
        run NNPC_FreeD::RumorP_Favorite_End()

